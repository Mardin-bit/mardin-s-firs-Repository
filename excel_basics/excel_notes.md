# پروژه سد گتوند و کار با جداول/اکسل در پایتون

## دستور فراخوانی اکسل در کتابخانه ژوپیتر

ابتدا باید کتابخانه pandas را ایمپورت کنیم:

```python
import pandas as pd
#هر وقت ایمپورت رو میزنی بعد اسم یک کتابخانه یعنی اونو فراخوان میکنی و وقتی از پی دی نوشته یعنی به عنوان پی دی برای بقیه خط ها آدرس میدی
df = pd.read_excel('merge_precipitation_gotvand.xlsx')
رید اکسل تابعی است از pandas که با pd مشخصش کردیم. در خط بالا که اکسل را به دیتا فریم تغییر می‌دهد و df هم همان دیتا فریم فضای مورد نظر ما هستش. عملگر پی دی برای این است که در فضای پاندا بخواند آن را
برای تست اینکه در دیتا فریم چه داده‌ای وارد کردیم:
df.head()
نمایش ۵ ردیف اول برای تست.
---

## دستور پاکسازی ستون‌های اضافه و نام‌گذاری دو ستون لازم در اکسل

فرض کنید فقط دو ستون از دیتافریم برای ما مهم است و می‌خواهیم بقیه را حذف کنیم:

```python
df_selected = df[['Persian Date', 'Unnamed: 5']].copy()
یک دیتافریم جدید با نام df_selected ساختیم که فقط شامل ستون‌های 'Persian Date' و 'Unnamed: 5' از دیتافریم اصلی است.

با استفاده از .copy() یک نسخه مستقل از داده‌ها گرفتیم تا تغییرات بعدی فقط روی این دیتافریم اعمال شود.
**نکته مهم:** 
انتخاب یک ستون (Series)	df['Year']
انتخاب چند ستون (DataFrame) با سه ستون	df[['Year', 'Month', 'Day']]
مقداردهی به یک ستون	df['Year'] = ...
مقداردهی به سه ستون همزمان (مثلاً split تاریخ)	df[['Year', 'Month', 'Day']] = ...
#علامت ' ' یا " " یا « » (سینگل یا دابل کوتیشن) چه کاربردی دارد؟
هر چیزی که بین تک‌کوتیشن (' ') یا دابل‌کوتیشن (" ") بنویسی، پایتون آن را رشته (متن، string) در نظر می‌گیرد.
**نکته مهم:**
در مساوی داخل کد نویسی سمت راست اطلاعات ورودی است و سمت چپ اطلاعات خروجی هستند 
```python
df_selected.columns = ['Persian Date', 'Precipitation']
نحوه خوانش پایتون از چپ به راست هستش و و وقتی در [] دو تا اسم به صورت رشته میدیم به ترتیب از چپ به راست آن ها را شماره یک و دیگری را شماره دو و بعد از خروجی میخواهیم این ها را ستون در نظر بگیر یعنی این دو تا رو به عنوان ستون لحاظ میکنه
## تبدیل مقادیر به عدد
برای اینکه مقادیر داخل اکسل محاسبات ریاضی یا آماری انجام دهند و با رشته اشتباه گرفته نشوند، باید دستور زیر را اجرا کنیم:
```python
df_selected['Precipitation'] = pd.to_numeric(df_selected['Precipitation'], errors='coerce')
ستون بارش را که قبلا گفتیم این ستون را برایمان تشکیل بده با دستوری که از پاندا فراخوان میکنیم تبدیل به عدد میکنیم به جز اونایی که ارور میدن و بعد در همان بارش قرار میدیمش اینerrors='coerce' هم سلول هایی که مقدار ندارند را nan در نظر میگیرد. 
برای انتخاب یک ردیف خاص هم می‌توانی از دستور زیر استفاده کنی:
df_selected.iloc[1]

df_selected.iloc[0] → ردیف اول (اندیس ۰)
df_selected.iloc[1] → ردیف دوم (اندیس ۱)
df_selected.iloc[2] → ردیف سوم (اندیس ۲)

برای نمایش یک سلول df_selected.iloc[1]['Precipitation'] اوکیه که میگه ردیف 2 و ستون بارش
**تبدیل مقادیر به رشته 

